<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Rectangular dual and REL visualiser</title>


    <link rel="stylesheet" href="css/graphStyle.css">
    <link rel="stylesheet" href="css/pageStyle.css">

</head>

<body>
    <!-- markers -->
    <svg width="0" height="0">
        <defs>
            <marker id="arrowRed" orient="auto" markerUnits="strokeWidth" 
            viewBox="0 0 9 9" markerWidth="9" markerHeight="9" refX="9" refY="3">
                <path class="red" d="M0,0 L1,3 L0,6 L8,3 z"></path>
            </marker>
            <marker id="arrowBlue" orient="auto" markerUnits="strokeWidth" 
            viewBox="0 0 9 9" markerWidth="9" markerHeight="9" refX="10" refY="3">
                <path class="blue" d="M0,0 L1,3 L0,6 L8,3 z"></path>
            </marker>
        </defs>
    </svg>

    <!-- scripts -->
    <script type="modul" src="scripts/model.js"></script>
    <script type="modul" src="scripts/view.js"></script>
    <script type="modul" src="scripts/controller.js"></script>

    <div style="display: flex;">
        <!-- Sidebar -->
        <aside style="width: 10%;">
            Tools: <br>
            <div class="toolbar" id="toolbar">
                <input class="mainMode" type="radio" id="drawGraphRadio" name="tools" value="drawGraph">
                <label for="drawGraphRadio" id="drawGraph">Draw graph</label>
                <div class="subtoolbar hidden" id="drawToolbar">
                    <input class="drawMode" type="radio" id="addRadio" name="tools" value="add">
                    <label for="addRadio" id="add">Add</label>
                    <input class="drawMode" type="radio" id="moveRadio" name="tools" value="move">
                    <label for="moveRadio" id="move">Move</label>
                    <input class="drawMode" type="radio" id="removeRadio" name="tools" value="remove">
                    <label for="removeRadio" id="remove">Remove</label>
                </div>
                <label id="saveGraph">Save graph</label>
                <div class="buttonTool">
                    <input type="file" id="file-input" />
                    <label id="read-button">Load graph</label>
                </div>
                <label id="saveSVG">Save SVG</label>
                <div class="toolbarRange">
                    Vertex size
                    <input type="range" min="1" max="20" value="7" class="slider" id="vertexSizeRange">
                </div>
                <div class="toolbarRange">
                    Edge size
                    <input type="range" min="1" max="10" value="2" class="slider" id="edgeWidthRange">
                </div>
                <label id="checkGraph">Check graph</label>
                <label id="computeREL">Compute REL</label>
                <div class="toolbarCheckbox">
                    <label id="showFlipCycles">
                        Show flip cycles
                    </label>
                    <div class="toolbarRow">
                        <input class="checkboxHidden" type="checkbox" id="cwFlips" name="tools" value="cwFlips">
                        <label for="cwFlips" id="move">CW</label>
                        <input class="checkboxHidden" type="checkbox" id="ccwFlips" name="tools" value="ccwFlips">
                        <label for="ccwFlips" id="remove">CCW</label>
                    </div>
                </div>
                <label id="computeRD">Compute RD</label>
            </div>
        </aside>

        <!-- Main -->
        <main style="flex: 1; overflow: auto;">
            <!-- svg -->
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 700 360" id="theSVG">
            </svg>
        </main>
    </div>

    <script type="module">
        import * as controller from "./scripts/controller.js";
        import * as view from "./scripts/view.js";
        import { initGraph } from "./scripts/model.js";
        view.initSVG();
        view.initSizes(document.getElementById("vertexSizeRange").value, document.getElementById("edgeWidthRange").value);
        initGraph();

        import { toolSelected } from "./scripts/controller.js";
        let tools = document.getElementById("toolbar").getElementsByClassName("mainMode");
        for (let tool of tools) {
            tool.checked = false;
            tool.addEventListener("input", function (event) {
                controller.toolSelected(this, event);
            });
        }

        // saving, loading, checking
        document.getElementById("saveGraph").addEventListener("click", controller.saveGraphHandler);
        document.getElementById("saveSVG").addEventListener("click", controller.saveSVGHandler);
        document.getElementById("read-button").addEventListener('click', controller.readFileHandler);
        document.getElementById("checkGraph").addEventListener('click', controller.checkGraphHandler);
        document.getElementById("computeREL").addEventListener('click', controller.computeRELHandler);
        document.getElementById("showFlipCycles").addEventListener('click', controller.showFlipCyclesHandler);
        document.getElementById("computeRD").addEventListener('click', controller.computeRDHandler);

        // sliders
        document.getElementById("vertexSizeRange").addEventListener("input", controller.rangeEventHandler);
        document.getElementById("edgeWidthRange").addEventListener("input", controller.rangeEventHandler);
    </script>


</body>

</html>